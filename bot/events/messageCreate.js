const {prefix} = require('../config.json');
const {UserManager} = require('../utils/userManager');
const rollName = require('../messages/roll_name');
const roll_alias = require('../messages/roll_alias');
const rollRarity = require('../utils/roll');
const submit = require('../messages/submit');

const userManager = new UserManager;

module.exports = (client, message) => {
    nameInputHandle(client, message);
   
}

async function nameInputHandle(client, message) {
    const id = message.author.id;
    message.react('ü§î')
    if (message.author.bot || message.channel.type === 'dm') return;
    if (!message.content.startsWith(prefix)) return;
    rollName(message, userManager);
    roll_alias(message, userManager);
    submit(message);
    
    if (message.content.startsWith(`${prefix}name_all`)) {
        if (!message.member.user.username === "CyberSlug") {
            message.reply(`–ß–µ–ª, —Ç–µ–±–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞`);
            return;
        }
        const list = client.guilds.cache.get("198556391114276864"); 
        list.members.cache.forEach(async (member) => {
            const id = member.user.id;
            if (member.user.username === "CyberSlug") return;
            const user = await userManager.find(member.user.id)
            if ( user === null) {                
                const newName = await rollRarity("name");
                const newAlias = await rollRarity("alias");
                const newUser = await userManager.create({id, name:newName, alias: newAlias, points: 10});            
                const fullName = await userManager.getFullName(newUser);
                member.setNickname(fullName);
                console.log("–ò–∑–º–µ–Ω–µ–Ω", fullName);
                return;
            } 
        })
    }
    if (message.content.startsWith(`${prefix}–±–æ—Ç, —Ç—ã`)) {
        message.reply(`‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ø‚†ø‚†ü‚†õ‚†õ‚†õ‚†õ‚†õ‚†õ‚†õ‚°õ‚†ø‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ø‚†õ‚†õ‚†â‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†í‚†Ä‚†Ä‚†Ä‚†à‚†ë‚†Ç‚†à‚†ô‚†ª‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†õ‚†∑‚†§‚£Ñ‚†à‚†õ‚†¶‚£Ä‚†Ä‚†ë‚†Ç‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ê‚†Ç‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚†í‚†§‚£ò‚£Ø‚°ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ì‚†¢‚¢§‚£Ä‚†Ä‚†Ä‚†ô‚¢¶‚°Ä‚†à‚†ì‚¢§‚°Ä‚†Ä‚†Ä‚†â‚†ê‚††‚¢Ä‚†Ä‚†Ä‚†à‚†ê‚†Ñ‚°Ä‚†à‚†¢‚°Ä‚†Ä‚†Ä‚†π‚£∑‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°∑‚°∂‚†§‚£Ñ‚°à‚†≥‚£§‚°Ä‚†Ä‚†ô‚†≤‚£Ñ‚°Ä‚†à‚†ì‚†§‚£Ä‚°Ä‚†Ä‚†Ä‚†ë‚†Ç‚†Ä‚†Ä‚†Ä‚¢Ä‚°ê‚†Ä‚£à‚£Å‚£†‚°Ä‚°ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†â‚†ª‚£∑‚£§‚°ô‚¢¶‚£§‚£ç‚£ì‚£¶‚£∞‚£∂‚°Ω‚£∑‚£∂‚°ü‚†õ‚†ø‚†ø‚†∂‚†ü‚†õ‚†õ‚†õ‚†õ‚†ã‚†â‚†â‚†ã‚†à‚†â‚†ô‚†â‚†â‚†õ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚†É‚†Ä‚†Ä‚†Ä‚†â‚†õ‚¢¶‚£ô‚°Ñ‚†Ä‚†â‚†â‚°ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚†è‚†Ä‚¢Ä‚°Ä‚†Ä‚£Ä‚£Ä‚†Ä‚†à‚†è‚†Ä‚†Ä‚†Ä‚£á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚†è‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚††‚†Ä‚†Ä‚¢π‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚°Ä‚£¶‚£Ä‚£§‚£∂‚£í‚£∂‚£§‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢ø‚†Ä‚¢Ä‚£†‚°∂‚†õ‚†â‚†ª‚£Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚†ô‚†ö‚†õ‚£¶‚†§‚°§‚†¨‚°ô‚†ì‚†¶‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚°á‚¢ø‚°â‚†Ä‚†í‚†¢‚°Ñ‚¢π‚°Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚†á‚†Ä‚†Ü‚†Ä‚£ª‚£õ‚£Ç‚£§‚†ú‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚£è‚†≥‚£Ω‚£§‚°¥‚†¶‚°å‚°Ñ‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚†è‚†Ä‚°å‚†Ä‚†Ä‚†à‚†â‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚°è‚†≥‚°Ñ‚¢∏‚°á‚†Ä‚¢Ä‚†á‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚°ü‚†Ä‚†Ä‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∞‚£¥‚°ã‚†π‚£ó‚°ô‚†ª‚°á‚†Ä‚†à‚£∞‚†á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∞‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†§‚¢Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚°ú‚¢ø‚†Ä‚†π‚¢¶‚°Ä‚¢®‚°Å‚£á‚¢Ä‚£º‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£¶‚£§‚£§‚£∂‚£§‚£§‚°®‚†Ä‚¢∞‚†ñ‚†í‚¢§‚°Ä‚°º‚°á‚†à‚†≥‚°Ä‚†Ä‚†Ä‚†Ä‚†ô‚£ø‚°è‚†ò‚†¶‚†§‚†§‚†§‚†¥‚†∂‚†¶‚†¥‚†ñ‚†í‚†ã‚¢ô‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚°á‚¢†‚°Ä‚¢®‚°ô‚†¶‚¢§‚£∏‚†ü‚°Ü‚¢†‚¢ª‚†É‚¢∑‚†Ä‚†Ä‚†ò‚†¶‚†Ä‚†Ä‚†Å‚†à‚¢ª‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£∑‚£¶‚£µ‚£Ñ‚†â‚°Ä‚†Ä‚†à‚¢ø‚†Å‚¢¥‚°æ‚†Ä‚†à‚¢ß‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚¢π‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£∑‚£ø‚£ø‚£ø‚£ø‚°ü‚†ö‚£ø‚†ø‚†∂‚†∂‚†∂‚£¶‚†É‚°¥‚†∂‚†∂‚†∂‚†∂‚£∂‚†æ‚†∑‚†∂‚†∂‚†∂‚†∂‚†∂‚†∂‚£¶‚†Ä‚£†‚°¥‚†∂‚†õ‚†õ‚†õ‚†ª‚†ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚°ü‚†â‚†Å‚†Ä‚£ø‚†â‚†Ñ‚¢ª‚°Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚°á‚†Ä‚†Ä‚†Ä‚¢Ä‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£º‚†ã‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚¢Ø‚†á‚†Ä‚†Ä‚†Ä‚£º‚†Ä‚†à‚¢∏‚£ß‚†Ä‚†Ä‚†Ä‚†à‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚£º‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£Ä‚£Ä‚£ø‚°è‚†Ä‚†Ä‚†Ä‚†Ä‚£¥‚£Ü‚†Ä‚†Ä‚†Ä‚†Ä‚¢ª‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚°æ‚¢Ä‚†Ä‚†Ä‚¢†‚†è‚†Ä‚†Ä‚¢Ä‚£ø‚°Ñ‚†Ä‚†Ä‚†Ä‚†ü‚†Ä‚†Ä‚†Ä‚¢∞‚£è‚£Ω‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚†Ä‚†Ä‚†∏‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†ª‚£ø‚£Ä‚£Ä‚£Ä‚£Ä‚£º‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£Ñ‚£∏‚£§‚£¥‚†ã‚†Ñ‚†Ä‚°Ñ‚†à‚°ª‚£ß‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£æ‚†Å‚¢∏‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†õ‚†õ‚†õ‚£∑‚£∑‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†õ‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚°á‚†ô‚†ã‚†à‚£∑‚†Ä‚†Ä‚†Ä‚†à‚†Ä‚†Å‚¢π‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚†á‚†Ä‚¢∏‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚£∑‚£Ñ‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚°Ä‚°Ä‚†Ñ‚†Ä‚†Ä‚†Ü‚†Ä‚†Ä‚°Ä‚¢Ä‚£¨‚£∑‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚°ü‚†Ä‚†Ä‚¢∏‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£¥‚£∂‚£∂‚£ø‚£ø‚£ø‚£ø‚£ø‚£∂‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢π‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£Ñ‚£†‚£Ñ‚£Ä‚£Ä‚£†‚£ø‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚°á‚£Ä‚£†‚£º‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚£ø‚£ø‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£∑‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£ø‚£ø‚£ø‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†õ‚†õ‚†õ‚¢ª‚£∑‚†Ä‚†Ä‚†Ä‚†Ä‚¢ª‚°ø‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚°ü‚†õ‚†õ‚†õ‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£º‚°á‚†Ä‚†Ä‚†Ä‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚£§‚£§‚£§‚£º‚£ø‚£ø‚£ø‚£ø‚£¶‚£§‚£§‚£§‚£§‚£§‚£§‚£§‚£º‚£ø‚£ø‚£∑‚£¶‚£§‚£§‚£§‚£§‚£§‚£∂‚£ø‚£ø‚£∑‚£§‚£§‚£§‚£ø
        ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø`)
    }
    if (message.content.startsWith(`${prefix}give_points`)) {
        if (message.member.user.username !== "CyberSlug") {
            message.reply('–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã');
        } else {
            const [id, amount] = message.content.split(' ')[1].split('_');
            const [isChanged, currentAmount] = changeUserPoints(id, amount);
            if ( isChanged ) {
                message.reply(`Points successfuly added to user #${id} `);
            } else {
                message.reply(`oshibka`)
            }
            
        }
    }
}